<ui:composition template="/template/user.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                >
    <ui:define name="title">MantechHelpDesk: Administrator >> Generate reports</ui:define>
    <ui:define name="content">
        <p:panel id="reportPanel" header="Generate different kinds of reports">
            <p:panelGrid columns="3" id="reportSelectKindSection">
                <p:outputLabel value="Select kind of report" for="reportKinds" />
                <p:selectOneMenu id="reportKinds" value="#{complaint.selectedKindOfReport}"  >
                    <f:selectItems value="#{complaint.allKindsOfReport}" var="kind"
                                   itemLabel="#{kind.name}" itemValue="#{kind.kindId}"/>
                </p:selectOneMenu>
                <p:commandButton id="btnViewReport" value="View report"
                                 action="#{complaint.previewReport}"
                                 update="reportTable"/>
            </p:panelGrid>
        </p:panel>
        <br/>
        <p:panel id="reportResultTable" header="Preview report">
            <p:dataTable value="#{complaint.allKindReportComplaints}" 
                         var="item" id="reportTable"
                         rowKey="#{item.complaintID}" selectionMode="single" 
                         paginator="true" rows="10"  
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                         rowsPerPageTemplate="5,10,15">
                <p:column headerText="ID">
                    #{item.complaintID}
                </p:column>
                <p:column headerText="Subject">
                    #{item.complaintSubject}
                </p:column>
                <p:column headerText="Creation Date">
                    <h:outputText value="#{item.lodgingDate}">
                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />
                    </h:outputText>
                </p:column>
                <p:column headerText="Last Modified Date">
                    <h:outputText value="#{item.lastModified}">
                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />
                    </h:outputText>
                </p:column>
                <p:column headerText="Closing Date">
                    <h:outputText value="#{item.closingDate}">
                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />
                    </h:outputText>
                </p:column>
                <p:column headerText="Actual Taken Time">
                    <h:outputText value="#{item.actualTakenDays}d:#{item.actualTakenHours}h:#{item.actualTakenMinutes}m:#{item.actualTakenSeconds}s" rendered="${item.status.statusID == 4}"/>
                </p:column>
                <p:column headerText="Technician">
                    #{item.technician.name}
                </p:column>
                <p:column headerText="Status">
                    #{item.status.statusName}
                </p:column>
                <p:column headerText="Action" >
                    <p:commandLink id="btnResend" value="Resend" rendered="${item.resend}" 
                                   action="#{complaint.resendComplaintItem}" ajax="true">
                        <f:setPropertyActionListener target="#{complaint.resendComplaintId}"
                                                     value="#{item.complaintID}" 
                                                     rendered="${item.resend}"/>
                    </p:commandLink>
                </p:column>
                <p:column headerText="Priority">
                    #{item.priority.priorityName}
                </p:column>
                <p:column headerText="Category">
                    #{item.complaintCategory.categoryName}
                </p:column>
            </p:dataTable>
        </p:panel>
    </ui:define>
</ui:composition>